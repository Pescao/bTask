Backbone.ChildViewContainer=function(e,c){var h=function(b){this._views={};this._indexByModel={};this._indexByCollection={};this._indexByCustom={};this._updateLength();this._addInitialViews(b)};c.extend(h.prototype,{add:function(b,c){var a=b.cid;this._views[a]=b;b.model&&(this._indexByModel[b.model.cid]=a);b.collection&&(this._indexByCollection[b.collection.cid]=a);c&&(this._indexByCustom[c]=a);this._updateLength()},findByModel:function(b){return this.findByCid(this._indexByModel[b.cid])},findByCollection:function(b){return this.findByCid(this._indexByCollection[b.cid])},
findByCustom:function(b){return this.findByCid(this._indexByCustom[b])},findByIndex:function(b){return c.values(this._views)[b]},findByCid:function(b){return this._views[b]},remove:function(b){var c=b.cid;b.model&&delete this._indexByModel[b.model.cid];b.collection&&delete this._indexByCollection[b.collection.cid];var a,d;for(d in this._indexByCustom)if(this._indexByCustom.hasOwnProperty(d)&&this._indexByCustom[d]===c){a=d;break}a&&delete this._indexByCustom[a];delete this._views[c];this._updateLength()},
call:function(b,c){c=Array.prototype.slice.call(arguments,1);this.apply(b,c)},apply:function(b,e){e=e||[];c.each(this._views,function(a,d){c.isFunction(a[b])&&a[b].apply(a,e)})},_updateLength:function(){this.length=c.size(this._views)},_addInitialViews:function(b){if(b){var c,a,d=b.length;for(a=0;a<d;a++)c=b[a],this.add(c)}}});c.each("forEach each map find detect filter select reject every all some any include contains invoke toArray first initial rest last without isEmpty pluck".split(" "),function(b){h.prototype[b]=
function(){var e=[c.values(this._views)].concat(c.toArray(arguments));return c[b].apply(c,e)}});return h}(Backbone,_);
Backbone.Wreqr=function(e,c,h){c={};c.Handlers=function(b,c){var a=function(){this._handlers={}};a.extend=b.Model.extend;c.extend(a.prototype,{addHandler:function(a,b,c){this._handlers[a]={callback:b,context:c}},getHandler:function(a){var b=this._handlers[a];if(!b)throw Error("Handler not found for '"+a+"'");return function(){var a=Array.prototype.slice.apply(arguments);return b.callback.apply(b.context,a)}},removeHandler:function(a){delete this._handlers[a]},removeAllHandlers:function(){this._handlers=
{}}});return a}(e,h);c.Commands=function(b){return b.Handlers.extend({execute:function(){var b=arguments[0],a=Array.prototype.slice.call(arguments,1);this.getHandler(b).apply(this,a)}})}(c);c.RequestResponse=function(b){return b.Handlers.extend({request:function(){var b=arguments[0],a=Array.prototype.slice.call(arguments,1);return this.getHandler(b).apply(this,a)}})}(c);c.EventAggregator=function(b,c){var a=function(){};a.extend=b.Model.extend;c.extend(a.prototype,b.Events);return a}(e,h);return c}(Backbone,
Backbone.Marionette,_);
var Marionette=function(e,c,h){var b={};e.Marionette=b;var p=Array.prototype.slice;b.extend=e.Model.extend;b.getOption=function(a,d){if(a&&d)return a.options&&d in a.options&&void 0!==a.options[d]?a.options[d]:a[d]};b.createObject=function(){function a(){}return"function"===typeof Object.create?Object.create:function(d){a.prototype=d;d=new a;a.prototype=null;return d}}();b.triggerMethod=function(){for(var a=Array.prototype.slice.apply(arguments),d=a[0].split(":"),b,g,n="on",e=0;e<d.length;e++)b=d[e],
g=b.charAt(0).toUpperCase(),n+=g+b.slice(1);this.trigger.apply(this,a);if(c.isFunction(this[n]))return a.shift(),this[n].apply(this,a)};b.MonitorDOMRefresh=function(){function a(a){a._isShown&&a._isRendered&&c.isFunction(a.triggerMethod)&&a.triggerMethod("dom:refresh")}return function(b){b.listenTo(b,"show",function(){b._isShown=!0;a(b)});b.listenTo(b,"render",function(){b._isRendered=!0;a(b)})}}();(function(a){function b(a,d,f,g){g=g.split(/\s+/);c.each(g,function(b){var c=a[b];if(!c)throw Error("Method '"+
b+"' was configured as an event handler, but does not exist.");a.listenTo(d,f,c,a)})}function f(a,b,d,c){a.listenTo(b,d,c,a)}function g(a,b,d,f){f=f.split(/\s+/);c.each(f,function(c){var f=a[f];a.stopListening(b,d,f,a)})}function e(a,b,d,c){a.stopListening(b,d,c,a)}function k(a,b,d,f,g){b&&d&&(c.isFunction(d)&&(d=d.call(a)),c.each(d,function(d,e){c.isFunction(d)?f(a,b,e,d):g(a,b,e,d)}))}a.bindEntityEvents=function(a,c,g){k(a,c,g,f,b)};a.unbindEntityEvents=function(a,b,d){k(a,b,d,e,g)}})(b);b.Callbacks=
function(){this._deferred=h.Deferred();this._callbacks=[]};c.extend(b.Callbacks.prototype,{add:function(a,b){this._callbacks.push({cb:a,ctx:b});this._deferred.done(function(c,g){b&&(c=b);a.call(c,g)})},run:function(a,b){this._deferred.resolve(b,a)},reset:function(){var a=this,b=this._callbacks;this._deferred=h.Deferred();this._callbacks=[];c.each(b,function(b){a.add(b.cb,b.ctx)})}});b.Controller=function(a){this.triggerMethod=b.triggerMethod;this.options=a||{};c.isFunction(this.initialize)&&this.initialize(this.options)};
b.Controller.extend=b.extend;c.extend(b.Controller.prototype,e.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});b.Region=function(a){this.options=a||{};this.el=b.getOption(this,"el");if(!this.el){var d=Error("An 'el' must be specified for a region.");d.name="NoElError";throw d;}this.initialize&&(d=Array.prototype.slice.apply(arguments),this.initialize.apply(this,d))};c.extend(b.Region,{buildRegion:function(a,b){var c="string"===typeof a,g="string"===typeof a.selector,
e="undefined"===typeof a.regionType,k="function"===typeof a;if(!k&&!c&&!g)throw Error("Region must be specified as a Region type, a selector string or an object with selector property");var h,l;c&&(h=a);a.selector&&(h=a.selector);k&&(l=a);!k&&e&&(l=b);a.regionType&&(l=a.regionType);return new l({el:h})}});c.extend(b.Region.prototype,e.Events,{show:function(a){this.ensureEl();this.close();a.render();this.open(a);a._isShown&&a.delegateEvents();b.triggerMethod.call(a,"show");b.triggerMethod.call(this,
"show",a);this.currentView=a},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(a){return h(a)},open:function(a){this.$el.empty().append(a.el)},close:function(){var a=this.currentView;a&&!a.isClosed&&(a.close&&a.close(),b.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(a){this.currentView=a},reset:function(){this.close();delete this.$el}});b.Region.extend=b.extend;b.TemplateCache=function(a){this.templateId=a};c.extend(b.TemplateCache,
{templateCaches:{},get:function(a){var d=this.templateCaches[a];d||(d=new b.TemplateCache(a),this.templateCaches[a]=d);return d.load()},clear:function(){var a,b=Array.prototype.slice.apply(arguments),c=b.length;if(0<c)for(a=0;a<c;a++)delete this.templateCaches[b[a]];else this.templateCaches={}}});c.extend(b.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var a=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(a)},loadTemplate:function(a){var b=
h(a).html();if(!b||0===b.length)throw a=Error("Could not find template: '"+a+"'"),a.name="NoTemplateError",a;return b},compileTemplate:function(a){return c.template(a)}});b.Renderer={render:function(a,d){return("function"===typeof a?a:b.TemplateCache.get(a))(d)}};b.View=e.View.extend({constructor:function(){c.bindAll(this,"render");var a=Array.prototype.slice.apply(arguments);e.View.prototype.constructor.apply(this,a);b.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:b.triggerMethod,
getTemplate:function(){return b.getOption(this,"template")},mixinTemplateHelpers:function(a){a=a||{};var b=this.templateHelpers;c.isFunction(b)&&(b=b.call(this));return c.extend(a,b)},configureTriggers:function(){if(this.triggers){var a=this,b={},f=c.result(this,"triggers");c.each(f,function(c,f){b[f]=function(b){b&&b.preventDefault&&b.preventDefault();b&&b.stopPropagation&&b.stopPropagation();a.triggerMethod(c,{view:this,model:this.model,collection:this.collection})}});return b}},delegateEvents:function(a){this._delegateDOMEvents(a);
b.bindEntityEvents(this,this.model,b.getOption(this,"modelEvents"));b.bindEntityEvents(this,this.collection,b.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(a){a=a||this.events;c.isFunction(a)&&(a=a.call(this));var b={},f=this.configureTriggers();c.extend(b,a,f);e.View.prototype.delegateEvents.call(this,b)},undelegateEvents:function(){var a=Array.prototype.slice.call(arguments);e.View.prototype.undelegateEvents.apply(this,a);b.unbindEntityEvents(this,this.model,b.getOption(this,
"modelEvents"));b.unbindEntityEvents(this,this.collection,b.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){this.isClosed||!1===this.triggerMethod("before:close")||(this.isClosed=!0,this.triggerMethod("close"),this.remove())},bindUIElements:function(){if(this.ui){var a=this;this.uiBindings||(this.uiBindings=c.result(this,"ui"));this.ui={};c.each(c.keys(this.uiBindings),function(b){a.ui[b]=a.$(a.uiBindings[b])})}}});b.ItemView=b.View.extend({constructor:function(){var a=
Array.prototype.slice.apply(arguments);b.View.prototype.constructor.apply(this,a)},serializeData:function(){var a={};this.model?a=this.model.toJSON():this.collection&&(a={items:this.collection.toJSON()});return a},render:function(){this.isClosed=!1;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var a=this.serializeData(),a=this.mixinTemplateHelpers(a),d=this.getTemplate(),a=b.Renderer.render(d,a);this.$el.html(a);this.bindUIElements();this.triggerMethod("render",
this);this.triggerMethod("item:rendered",this);return this},close:function(){if(!this.isClosed){this.triggerMethod("item:before:close");var a=Array.prototype.slice.apply(arguments);b.View.prototype.close.apply(this,a);this.triggerMethod("item:closed")}}});b.CollectionView=b.View.extend({itemViewEventPrefix:"itemview",constructor:function(a){this._initChildViewStorage();var d=Array.prototype.slice.apply(arguments);b.View.prototype.constructor.apply(this,d);this._initialEvents()},_initialEvents:function(){this.collection&&
(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(a,b,c){this.closeEmptyView();b=this.getItemView(a);c=this.collection.indexOf(a);this.addItemView(a,b,c)},onShowCalled:function(){this.children.each(function(a){b.triggerMethod.call(a,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",
this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=!1;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.closeEmptyView();this.closeChildren();this.collection&&0<this.collection.length?this.showCollection():this.showEmptyView()},showCollection:function(){var a=this,b;this.collection.each(function(c,g){b=a.getItemView(c);a.addItemView(c,
b,g)})},showEmptyView:function(){var a=b.getOption(this,"emptyView");if(a&&!this._showingEmptyView){this._showingEmptyView=!0;var d=new e.Model;this.addItemView(d,a,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(a){a=b.getOption(this,"itemView");if(!a)throw a=Error("An `itemView` must be specified"),a.name="NoItemViewError",a;return a},addItemView:function(a,d,f){var g=b.getOption(this,"itemViewOptions");c.isFunction(g)&&
(g=g.call(this,a));a=this.buildItemView(a,d,g);this.addChildViewEventForwarding(a);this.triggerMethod("before:item:added",a);this.children.add(a);this.renderItemView(a,f);this._isShown&&b.triggerMethod.call(a,"show");this.triggerMethod("after:item:added",a)},addChildViewEventForwarding:function(a){var d=b.getOption(this,"itemViewEventPrefix");this.listenTo(a,"all",function(){var c=p.call(arguments);c[0]=d+":"+c[0];c.splice(1,0,a);b.triggerMethod.apply(this,c)},this)},renderItemView:function(a,b){a.render();
this.appendHtml(this,a,b)},buildItemView:function(a,b,f){a=c.extend({model:a},f);return new b(a)},removeItemView:function(a){a=this.children.findByModel(a);this.removeChildView(a);this.checkEmpty()},removeChildView:function(a){a&&(this.stopListening(a),a.close&&a.close(),this.children.remove(a));this.triggerMethod("item:removed",a)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendHtml:function(a,b,c){a.$el.append(b.el)},_initChildViewStorage:function(){this.children=
new e.ChildViewContainer},close:function(){if(!this.isClosed){this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");var a=Array.prototype.slice.apply(arguments);b.View.prototype.close.apply(this,a)}},closeChildren:function(){this.children.each(function(a){this.removeChildView(a)},this);this.checkEmpty()}});b.CompositeView=b.CollectionView.extend({constructor:function(a){var c=Array.prototype.slice.apply(arguments);b.CollectionView.apply(this,c);
this.itemView=this.getItemView()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))},getItemView:function(a){a=b.getOption(this,"itemView")||this.constructor;if(!a)throw a=Error("An `itemView` must be specified"),a.name="NoItemViewError",a;return a},serializeData:function(){var a={};this.model&&(a=this.model.toJSON());
return a},render:function(){this.isClosed=!1;this.resetItemViewContainer();this.triggerBeforeRender();var a=this.renderModel();this.$el.html(a);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){b.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")},renderCollection:function(){var a=Array.prototype.slice.apply(arguments);
b.CollectionView.prototype.render.apply(this,a)},renderModel:function(){var a={},a=this.serializeData(),a=this.mixinTemplateHelpers(a),c=this.getTemplate();return b.Renderer.render(c,a)},appendHtml:function(a,b){this.getItemViewContainer(a).append(b.el)},getItemViewContainer:function(a){if("$itemViewContainer"in a)return a.$itemViewContainer;var b;if(a.itemViewContainer){if(b=c.result(a,"itemViewContainer"),b=a.$(b),0>=b.length)throw a=Error("The specified `itemViewContainer` was not found: "+a.itemViewContainer),
a.name="ItemViewContainerMissingError",a;}else b=a.$el;return a.$itemViewContainer=b},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}});b.Layout=b.ItemView.extend({regionType:b.Region,constructor:function(){this._firstRender=!0;this.initializeRegions();var a=Array.prototype.slice.apply(arguments);b.ItemView.apply(this,a)},render:function(){this._firstRender?this._firstRender=!1:(this.closeRegions(),this.reInitializeRegions());var a=Array.prototype.slice.apply(arguments);
return b.ItemView.prototype.render.apply(this,a)},close:function(){if(!this.isClosed){this.closeRegions();this.destroyRegions();var a=Array.prototype.slice.apply(arguments);b.ItemView.prototype.close.apply(this,a)}},initializeRegions:function(){this.regionManagers||(this.regionManagers={});var a=this;c.each(this.regions||{},function(c,f){var g=b.Region.buildRegion(c,a.regionType);g.getEl=function(b){return a.$(b)};a.regionManagers[f]=g;a[f]=g})},reInitializeRegions:function(){this.regionManagers&&
0===c.size(this.regionManagers)?this.initializeRegions():c.each(this.regionManagers,function(a){a.reset()})},closeRegions:function(){c.each(this.regionManagers,function(a,b){a.close()})},destroyRegions:function(){var a=this;c.each(this.regionManagers,function(b,c){delete a[c]});this.regionManagers={}}});b.AppRouter=e.Router.extend({constructor:function(a){var c=Array.prototype.slice.apply(arguments);e.Router.prototype.constructor.apply(this,c);this.options=a;this.appRoutes&&(c=b.getOption(this,"controller"),
this.processAppRoutes(c,this.appRoutes))},processAppRoutes:function(a,b){var f,g,e,h,m,l=[];for(e in b)b.hasOwnProperty(e)&&l.unshift([e,b[e]]);h=l.length;for(m=0;m<h;m++){e=l[m][0];g=l[m][1];f=a[g];if(!f)throw f=Error("Method '"+g+"' was not found on the controller"),f.name="NoMethodError",f;f=c.bind(f,a);this.route(e,g,f)}}});b.Application=function(a){this.initCallbacks=new b.Callbacks;this.vent=new e.Wreqr.EventAggregator;this.commands=new e.Wreqr.Commands;this.reqres=new e.Wreqr.RequestResponse;
this.submodules={};c.extend(this,a);this.triggerMethod=b.triggerMethod};c.extend(b.Application.prototype,e.Events,{execute:function(){var a=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,a)},request:function(){var a=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,a)},addInitializer:function(a){this.initCallbacks.add(a)},start:function(a){this.triggerMethod("initialize:before",a);this.initCallbacks.run(a,this);this.triggerMethod("initialize:after",
a);this.triggerMethod("start",a)},addRegions:function(a){var d=this;c.each(a,function(a,c){var e=b.Region.buildRegion(a,b.Region);d[c]=e})},removeRegion:function(a){this[a].close();delete this[a]},module:function(a,c){var f=p.call(arguments);f.unshift(this);return b.Module.create.apply(b.Module,f)}});b.Application.extend=b.extend;b.Module=function(a,c){this.moduleName=a;this.submodules={};this._setupInitializersAndFinalizers();this.app=c;this.startWithParent=!0;this.triggerMethod=b.triggerMethod};
c.extend(b.Module.prototype,e.Events,{addInitializer:function(a){this._initializerCallbacks.add(a)},addFinalizer:function(a){this._finalizerCallbacks.add(a)},start:function(a){this._isInitialized||(c.each(this.submodules,function(b){var c=!0;(c=b.startWithParent)&&b.start(a)}),this.triggerMethod("before:start",a),this._initializerCallbacks.run(a,this),this._isInitialized=!0,this.triggerMethod("start",a))},stop:function(){this._isInitialized&&(this._isInitialized=!1,b.triggerMethod.call(this,"before:stop"),
c.each(this.submodules,function(a){a.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),b.triggerMethod.call(this,"stop"))},addDefinition:function(a,b){this._runModuleDefinition(a,b)},_runModuleDefinition:function(a,d){if(a){var f=c.flatten([this,this.app,e,b,h,c,d]);a.apply(this,f)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new b.Callbacks;this._finalizerCallbacks=new b.Callbacks}});c.extend(b.Module,
{create:function(a,b,f){var e=this,h=a,k=p.apply(arguments);k.splice(0,3);b=b.split(".");var m=[];m[b.length-1]=f;c.each(b,function(b,c){var d=h;h=e._getModule(d,b,a);e._addModuleDefinition(d,h,m[c],k)});return h},_getModule:function(a,c,f,e,h){e=a[c];e||(e=new b.Module(c,f),a[c]=e,a.submodules[c]=e);return e},_addModuleDefinition:function(a,b,e,g){var h;c.isFunction(e)?(h=e,e=!0):c.isObject(e)?(h=e.define,e=e.startWithParent):e=!0;h&&b.addDefinition(h,g);b.startWithParent=b.startWithParent&&e;b.startWithParent&&
!b.startWithParentIsConfigured&&(b.startWithParentIsConfigured=!0,a.addInitializer(function(a){b.startWithParent&&b.start(a)}))}});return b}(Backbone,_,$||window.jQuery||window.Zepto||window.ender);